---
import { TasksView } from "../../features/tasks/tasks-view";
import AppLayout from "../../layouts/app-layout.astro";
import { createSupabaseServerClient } from "../../shared/db/supabase-server";
import { AppRouter } from "../../shared/routing/app-router";

const supabase = createSupabaseServerClient({ cookies: Astro.cookies });

const {
  data: { user },
} = await supabase.auth.getUser();

if (!user) {
  return Astro.redirect(AppRouter.getPath('login'));
}
---

<AppLayout title="Tasks">
  <TasksView client:load />
</AppLayout>
